# LaravelSite
			<h4>		Сайт портфолио - Эта статья взята из моего сайта, который я все пытаюсь выложить на хостинг, но ввиду нехватки ресурсов, все не выкладываю. ))) 
            
 <p style="text-indent:50px">Для портфолио не только представление важно, но также важен и контент. Для моего портфолио как нельзя более кстати подходит проект по созданию веб приложения или веб сайта.  Поэтому, статья о том, как я создавал сайт портфолио и будет первым наполнением сайта.
<p style="text-indent:30px">Что такое сайт портфолио и вообще портфолио? Сайт портфолио  это представление одной персоны и создается как способ заявить о том, что есть такой вот человек и он имеет такие вот достоинства или недостатки, что часто одно и тоже. Т.е., сайт- портфолио это как витрина, сцена, подиум, где главный герой может показать себя,  чтобы привлечь внимание к себе или своим талантам с целью получения какой-либо выгоды!  Правильно!? Правильно.
<p style="text-indent:30px">Все хорошо, но мне не нравятся такие цели. Поэтому, главная цель, которую я ставил, ставлю и, надеюсь, буду ставить перед собой и своими делами -  это помочь другим.  Просто помочь, иногда бескорыстно или за финансовое вознаграждение, если это касается моей работы. Но и чтобы помощь была не напрасной. А что такое напрасная помощь,  я думаю, жизнь этого сайта и даст ответ на этот вопрос.
<p style="text-indent:30px">Но то была главная цель. А есть еще   первостепенные и второстепенные цели. И одна из первостепенных целей создания данного веб сайта это создать источник финансового  дохода, будь то проект или постоянное высокооплачиваемое рабочее место. 
<p style="text-indent:30px">Систематизация знаний и умений, контроль и управление собственными проектами и т.д., это тоже не второстепенные цели. 
<p style="text-indent:50px">Надо признаться, что это далеко не первый мой проект, но для данного сайта в частности и  всего большого проекта целиком, это будет мой первый! Первая задача, первая статья, первая реализация.  Все как-будто в первый раз. 
<p style="text-indent:30px"> С целями разобрались. Теперь, как я реализовывал проект, так сказать, путь от идеи до размещения и продвижения. 
<p style="text-indent:30px">Лиха беда начало! Умные люди говорят, что лучше один раз увидеть, чем сто раз услышать.  
<img src="{!!asset('front/img/avatar.jpg')!!}"  alt="firewood">
  <p style="text-indent:30px">Фотография красноречиво показывает и путь, и результат.  Как говорится - наломал дров! )) 
  <p style="text-indent:30px">Для создания веб сайта был выбран язык программирования php и фреймворка laravel. Почему фреймворк? Почему не чистый php? Для поддержки, для уменьшения времени разработки. Тут не только laravel, но и bootstrap, а также менеджеры пакетов, такие, как composer и npm. Еще вопрос может возникнуть - почему php, а не, например, JAVA или JavaScript?  На php для меня быстрее и проще, а на Java долго, хорошо, но долго. Мое мнение, Java не для портфолио.  Хотя...
<p style="text-indent:30px">Как создавать сайты правильно, как писать брифы и составлять техническое задание, составлять семантическое ядро и т.д., об этом написано много в интернете. Но это надо учить! И практиковать. Потому что, хоть идея это важная часть проекта, не менее важны реализация и поддержка. Хороших идей много, а хороших реализаций не очень. 
  <p style="text-indent:50px"> . Еще одно отличие данного сайта от многих в том, что здесь я хочу писать только полезный контент. А полезный контент это не просто описание. Это решение конкретных задач и  исправление ошибок. Это чистейшая практика и только практика.  Нет, ну выдержки из документации нужны, куда же без них.
  <p style="text-indent:50px">Так, необходимые отступления и описания сделаны и теперь вперед, реализация. 
<p style="text-indent:50px">Как при создании любого продукта, при создании вебсайта необходимо ответить на следующие вопросы:</p>
<ol> 
<li>Цели и задачи - для чего создается сайт  - выяснили, что цели в итоге исключительно корыстные. Тот случай, когда хотелось лучше, а получается как обычно.</li>
<li>Целевая аудитория - для кого создается сайт, область деятельности целевой аудитории - хочется охватить как можно более широкий круг читателей. И отобрать этих читателей у новостных сайтов. Хочу, чтобы люди перестали читать бессмысленные, нередко фейковые новости и занялись наконец-то делом, например, своим здоровьем или самореализацией! Перестали верить политикам вообще. Вот и открылась истинная цель данного сайта. </li>
<li>Конкуренты и партнеры  - анализ и состояние рынка </li>
<li>Контент-  с контентом определились это я и мои проекты.</li>
<li>Цели и стратегия продвижения сайта - об этом<a href ="CEO">тут.</a></li>
<li><a href="money">Монетизация сайта </a></li>
</ol> 
<p style="text-indent:30px"> После ответа на эти вопросы, приступим к списку всех шагов по созданию сайта:
<ul>
<li>Разработать или получить техническое задание</li>
<li>Разработать (заказать) дизайн страниц</li>
<li>Сделать верстку страниц</li>
<li>Запрограммировать  фронтэнд</li>
<li>Разработать дизайн или (заказать) админ панель</li>
<li>Сверстать страницы админ панели</li>
<li>Запрограммировать админ панель - бэкэнд</li>
<li>Наполнить сайт контентом</li>
<li>Зарегистрировать доменное имя</li>
<li>Хостинг - заказать, оплатить. </li>
<li>Разместить(залить) сайт на хостинге.</li>
<li>Выполнять работы по продвижению.</li>
<li>Наполнять сайт полезным контентом.</li>
</ul>
  <p style="text-indent:50px">Теперь реализуем каждый пункт.
1. Техническое задание - очень просто, берем и составляем)). Слишком просто, чтобы мы это делали. Поэтому, закажем у какого-нибудь тимлида, менеджера проекта или еще какого супер спеца. Ну что мы будем заниматься ерундой.))) Шутка. На самом деле, составить техзадание это очень ответственная часть и доверять ее нужно специалисту, а не себе. И лучше, чтобы техзадание было. Даже если это сайт для себя, а то ведь можно и с самим собой поссориться. ))
<p style="text-indent:30px">Не забыть про очень важные, если не самые важные пункты техзадания это аналитика и проектирование!!!
Техзадание <a href="techtaskt" rel="stylesheet">тут.</a>
2. Дизайн - нарисовать или взять готовый.  
<p style="text-indent:30px">Делаем рисунок, редактируем его в фотошопе, определяем шрифты, нарезаем для верстки и верстаем. Ничего сложного, кроме "делаем  рисунок". Самый лучший рисунок, который я нарисовал это белый лист. Ну еще как вариант, черный лист. Белая тема и черная тема.  Одним словом - готово.
3.  Для верстки используем фрэймворк bootstrap. Все, что нам надо,  сетка, адаптивность,  формы, кнопки, вкладки и т.д., все есть у bootstrap, как готовое решение.  Верстаем, подключая bootstrap. 
<p style="text-indent:50px">Готово. Готово это в том смысле, что берем готовый шаблон, нарисованный художником и сверстанный верстальщиком, бесплатный или платный и адаптируем. Главное это выполнять требования лицензии. Надо понимать, что HTML шаблоны уже сверстаны, причем для разных девайсов и браузеров и  имеют стили, т.е., шаблоны адаптивны. Остается только воспользоваться готовым проектом.
  <p style="text-indent:50px">Итак, адаптивный, кросс-браузерный  шаблон есть. Теперь программируем. 
4. Как уже решено, будем использовать php и laravel. Чтобы ничего не пропустить, составим список шагов по программированию, с использованием php и laravel:
 <ol>
 <li>Установить php</li>
 <li>Установить mysql</li>
<li>Установить npm</li>
 <li>Установить composer</li>
 <li>Создать laravel проект</li>
 <li>Запрограммировать проект</li>
<li>Создание или написание контента, текст, графика и т.д.</li>
 <li>Вывод всех статей</li>
 <li>Редактирование статьи</li>
 <li>Показ статьи</li>
 <li>Удаление статьи</li>
<li>Вывод 	на страницу сайта
</ol>
 <p style="text-indent:50px">Установка php, mysql, npm описаны в документации. Проблем быть не должно. Можно установить, например,OpenServer или Denver. В состав их входит и php, и mysql, и phpmyadmin, и веб сервер, и еще много разного, в том числе и бесполезного софта. После установки веб сервера, запускаем приложение, запускаем phpmyadmin и получаем доступ к базе данных. Можем создавать базы, таблицы, добавлять, удалять, редактировать данные, пользователей, привилегии и т.д.
 Тоже самое, можно делать из командной строки, запустив php и mysql - "mysql>". Даже и круче. Но мы будем использовать laravel и это тоже очень круто.
  <p style="text-indent:50px">Сначала создадим структуру сайта. Доверим эту работу фреймворку  laravel. PHP фреймворк, с шаблонизатором Blade, и простой маршрутизацией. Работа фреймворка  основана на контроллерах - всю работу, все обращения, ссылки и т.д. выполняются через контроллеры. Но, предварительно установим два программных продукта. Один Composer - менеджер пакетов и  зависимостей для PHP, второй NPM - то же только для JavaScript.  Оба работают в командной строке и упрощают работу разработчика до уровня - я думаю над работой приложения, а не как его заставить работать. Классная штука.
  <p style="text-indent:50px">Значит, MySql установлена, доступ настроен, пароли, логины, порты известны. 
  <p style="text-indent:50px">Еще нам надо определиться с инструментами, с помощью которых  и будем создавать наш, не побоюсь этого слова, шедевральный сайт. Согласитесь, хороший инструмент это большая часть работы.
<p style="text-indent:30px">  Для написания кода и редактирования будем использовать текстовый редактор Notepad++ - бесплатный, с кучей приятных горячих клавиш и плагинов.  А с учетом того, что структуру  сайта создает фрэймворк  Laravel, то этот редактор вообще крутой инструмент. Конечно, всякие вебphpштормы и тд. круты, но они стоят денег. А в notepad++  работа очень приятна, если, конечно, любишь программировать.
Языки программирования:
 <p style="text-indent:30px">HTML5&CSS3 &JS- стандарт для веб верстки и красивости или кривости.  Не, есть ещё много чего, тот же typescript и angular. Но будем применять то, что знаем.
До сих пор не люблю JS за то, что на нем делают крутые вещи, которые раньше делали с помощью CSS, что сильно сказывается на нагрузке компьютера. Но признаю - JS это круто.
 <p style="text-indent:30px">Bootstrap - крутая вещь для адаптивной вёрстки и кучей готовых скриптов и стилей. Сетка, кнопки, вкладки, формы и т.д.,  все есть.
 <p style="text-indent:30px">PHP + Laravel -  Без laravel  я писал сайт на чистом PHP. Laravel  с его маршрутизацией и  контроллерами, а главное, с возможностью выполнения php кода прямо в шаблоне, вьюшке ну и в контроллере, понятно - это то, что надо. И шаблонизатор Blade мне тоже нравится.
 А интернет магазин или соцсеть, я еще не решил, будем писать на Java + Spring или еще какой фрэймворк. А может и на PHP. По ходу решим.
<p style="text-indent:30px">Ах да, Искусственный интеллект возможно тоже будет. Python. Посмотрим, так ли он хорош.
<p style="text-indent:30px">Для проверки наш сайт будем "хакать" с помощью всего того, что имеет KaliLinux. А может Parrot хватит. По мере применения опишем каждый наш шаг.
 <p style="text-indent:30px">Но! Все-таки сначала создадим проект, наполним его контентом, а потом расскажу, как я "хакал" свой сайт.
  <p style="text-indent:30px">Продолжим.
  <p style="text-indent:50px">Выбрали инструмент. Как разрабатывать.   
<p style="text-indent:50px">Начнем с контента, с того, чем будем сайт наполнять. И хранить будем в базе данных. Сначала MySQL. Дальше подтянем PostgreSQL, Mongo. Там посмотрим.
 <p style="text-indent:30px"> Надо понимать, что база данных MySQL не для того,  чтобы хранить в ней тяжеловесную графику. Да, есть формат <a href="format_blob">blob</a>, но при попытке вывода на страницу графики из базы данных, мы видим проблему со скоростью загрузки. Поэтому, проблема. Будем решать по мере реализации проекта - ссылки в базе, сами материалы на диске.
  <p style="text-indent:50px">Вроде все описал. Доменное имя будет простое - VladimirBoiko. Или просто Boiko.  Или I'm Genius! 
Теперь, как сказал товарищ Гагарин Юрий Алексеевич, я, кстати, тоже Алексеевич и это еще один знак в мою пользу,  "ПОЕХАЛИ!!!"!
  <p style="text-indent:50px">Выполнили всю подготовительную работу. Вот теперь можно заняться проектом. 
   <p style="text-indent:30px">Работаем в терминале.
  <p style="text-indent:50px">Создаем проект на Laravel, введя в терминале:
<code>
 <p style="text-indent:30px">composer create-project --prefer-dist laravel/laravel VladimirBoiko
</code>
  <p style="text-indent:50px">Дальше переходим в терминале в каталог нашего проекта cd c:\projects\VladimirBoiko (в Windows, linux-оиды сами знают, как пользоваться терминалом) и устанавливаем нужные нам пакеты. 
 <p style="text-indent:30px">Для создания авторизации можно установить пакет  fortify:
    <p style="text-indent:30px"> Для начала установите Fortify с помощью менеджера пакетов Composer в свой проект:
	<p><code>
composer require laravel/fortify
</code>
 <p style="text-indent:30px">Затем, опубликуем ресурсы Fortify с помощью команды vendor:publish. Для этого выполним в терминале :
 <p><code>
 php artisan vendor:publish --provider="Laravel\Fortify\FortifyServiceProvider"
</code></p></p></p>
 <p style="text-indent:30px">Эта команда опубликует действия Fortify в вашем каталоге app/Actions, который будет создан, если он не существует. Кроме того, будет опубликован конфигурационный файл и миграции.
Затем нужно выполнить миграции, т.е., выполним SQL запрос:
php artisan migrate
<p style="text-indent:30px">И вот первая проблема, с которой могут не все столкнуться сразу, но могут столкнуться потом. Может появиться ошибка 
<code>
Errors with migartions SQLSTATE[42000]: Syntax error or access violation: 1071 
</code>
Если я правильно понял, ошибка появляется в случае разных версий MySQL и PHP. Если будет время, разберусь и распишу. А сейчас нашел решение и вперед
<p style="text-indent:30px">
Решение:
 <p style="text-indent:30px">Надо добавить к  app/providers/ AppServiceProvider.php 
<p><code>
use Illuminate\Support\Facades\Schema;

Добавляем в public function boot()
    {
        Schema::defaultStringLength(191);
    }
</code>
Если снова ошибка, а она будет:
<p>
Illuminate\Database\QueryException  : SQLSTATE[42S01]: Base table or view already exists:
<p>
,то удалить таблицы users и migrations, которые, скорее всего были созданы в  вашей базе данных когда вы первый раз применяли migrate:
и тогда выполним:
<p>
php artisan migrate
<p>
 Database migration created successfully.Ok!
<p>
Установим пакет User  Interface, надеюсь, понятно для чего
 Next ui
https://www.codegrepper.com/code-examples/php/laravel+8+ui+auth
<code> composer require laravel/ui </code>
<code>php artisan ui bootstrap --auth </code>
<code>npm install && npm run dev</code>

  <p style="text-indent:50px">Далее,  выполняем 
<code>npm run prod</code>
  <p style="text-indent:50px"> Теперь установим пакет для разграничения прав доступа:

   <p style="text-indent:50px">Например, Spatie

 Пакет spatie https://spatie.be/docs/laravel-permission/v5/installation-laravel

<code>composer require spatie/laravel-permission  </code>

  <p style="text-indent:50px"> Добавляем провайдера в config/app.php

 <code>Spatie\Permission\PermissionServiceProvider::class,</code>
  <p style="text-indent:50px">   "Сервис-провайдеры – это центральное место начальной загрузки всех приложений Laravel. Ваше собственное приложение, а также все основные службы и сервисы Laravel загружаются через них" - цитата из документации на laravel.  
   <p style="text-indent:50px"> Публикуем migration and the config/permission.php config file :

<code>php artisan vendor:publish --provider="Spatie\Permission\PermissionServiceProvider"</code>
<code>php artisan config:clear</code>
<code>php artisan migrate</code>
 <p style="text-indent:30px">Используя  artisan commands мы можем создавать роли или разрешения прямо из консоли:
<code>php artisan permission:create-role author</code>
<p style="text-indent:30px">Также можем создать роль admin:
<p style="text-indent:30px">
<code>
php artisan permission:create-role admin
</code>

И в app->Controllers->Auth->RegistrControler.php функцию create приводим к виду:
<p><code>
function create (array $data){
$user = User::create([
            'name' => $data['name'],
            'email' => $data['email'],
            'password' => Hash::make($data['password']),
        ]);

$user->assignRole('author');
    return $user;
}
</code>
Добавим к User from Models  - use HasRoles; 
 and use Spatie\Permission\Traits\HasRoles;        

Создаём маршрут
<p><code>
Route::get('test',function(){
return view('test');
});
</code>
После этого используем  посредник middleware
<p><code>
Route::group(['middleware' => ['role:admin']], function () {
Route::get('test',function(){
return view('test');
});

});
</code>
  <p style="text-indent:50px">"HTTP Middleware (посредники) - это фильтры обработки HTTP-запроса. Так, например, в Laravel включены middlewares для проверки аутентификации пользователя. Если пользователь не залогинен, middleware перенаправляет его на страницу логина. Если же залогинен - middleware не вмешивается в прохождение запроса, передавая его дальше по цепочке middleware-посредников к собственно приложению."(с)
Пакет middleware RoleMiddleware, PermissionMiddleware and RoleOrPermissionMiddleware middleware копируем в app/Http/Kernel.php file для регистрации:
<p><code>
protected $routeMiddleware = [
...
    'role' => \Spatie\Permission\Middlewares\RoleMiddleware::class,
    'permission' => \Spatie\Permission\Middlewares\PermissionMiddleware::class,
    'role_or_permission' => \Spatie\Permission\Middlewares\RoleOrPermissionMiddleware::class,
];
</code>
 <p style="text-indent:30px">Теперь мы можем установить разрешения для любого юзера и любой страницы или статьи.

 <p style="text-indent:30px">Все. Проект создан. Роли есть, можно посмотреть в DB, которую мы забыли создать)). Создаем базу SQL:
<code> 
create database ourproject
</code>
Да. В файле .env нужно установить правильные значения для доступа к базе данных:
   <p style="text-indent:50px">Database = mysql
  <p style="text-indent:50px"> namedb =ourproject
  <p style="text-indent:50px"> login = root
  <p style="text-indent:50px"> password=root
  <p style="text-indent:50px"> Port=127.0.0.1
<p style="text-indent:50px" >Небольшое отступление по поводу паролей. Несмотря на то, что уже лет 20 как, все и всем вокруг твердят - не ставьте один и тот же пароль на несколько приложений,  вебсайтов и так далее. меняется ровным счетом ничего! Не открою секрета, если скажу, что веб сайты воруют. Не потому, что они шедеврально красивы, оригинальны и супер cool! Банально, воруют, для того, чтобы спокойно взломать и получить пароли доступа. А учитывая, что юзеры не меняют пароли годами, да и еще один и тот же пароль на несколько учетных записей, то понятно, какой это клондайк для хакеров. Раньше, я смеялся над словами, произошла утечка данных, слили данные, хакеры взломали и т.д. Теперь только констатирую факт, перефразируя слова из старой, как я, песни - годы проходят, но не беда,  глупость не мода, а навсегда! Ставьте разные пароли, уйдите от алгоритмов, вроде, мои пароли это мой день,  место и год рождения. Будьте непредсказуемы. Надеюсь, вы поняли, что надо оставить пароль для доступа к базе данных - root! ))
<p style="text-indent:30px">
Теперь мы можем запустить веб сервер, встроенный в laravel php artisan serve - - port=8001
Порт можно не указывать, тогда запустится на порту 8000. И что особенно радует, можно запустить много веб-серверов, меняя номер порта.
И обращаться нужно в браузере указать http://localhost:800x
  <p style="text-indent:50px">Откроется страница welcome laravel, но  на ней уже будет  возможность авторизации login  и Auth.
Причём, скрипт авторизации будет как на странице приветствия, так и в отдельном файле. Удобно.
<p style ="text-indent:50px">Чтобы проверить работу разграничения доступа, зарегистрируемся два раза. Затем, просто откроем phpmyadmin, и найдём в нашей базе данных model_has_roles  роли наших юзеров  role_id и изменим значение одной модели roles_id на 2. Это роль admin.  Создадим файл test.blade.php в каталоге resources/view. Напишем в нем "only admin". 
Теперь можем пробовать открыть, залогинившись с разными login. http://localhost:8001/test.
И наслаждаемся доступами. 
 <p style="text-indent:30px">Что получилось:
 Имеем базу данных с доступом. Можно создавать контент.
 Отличная работа. Creat job!

//==============================================================

<p align ="center">Part 2. Admin panel.
 <p style="text-indent:30px">Вместо того, чтобы наполнять страницу контентом, создадим админ панель для редактирования, сохранения данных, вывода на страницу. Разработать админ панель с нуля просто, но сложно. И нудно. Шутка. Создать шаблон админки долго. И не легко. Поэтому, шаблон для админки делаем точно также, как и шаблон для показа контента. Т.е., рисуем дизайн, редактируем, нарезаем, верстаем, программируем. Так как, лучше всего, мы помним, нарисовать у меня получается чистый белый или чёрный лист, я говорил об этом, то мы возьмем готовую и адаптируем ее. Благо, готовых админок для laravel пруд пруди, а самому разрабатывать время, а главное, люди работали, разрабатывали, старались. Спасибо им большое. Мы будем соблюдать условия лицензий.
 <p style="text-indent:30px">Вот довольно простая админка - AdminLTE . Берём и работаем. Но в рабочем веб сайте будем ставить другую админ. Я даже не скажу какую, вот такой я загадочный. Шутка. Сам не знаю еще. October платная. Посмотрим.
  <p style="text-indent:50px">Скачиваем adminLTE, распаковываем во временную папку.
Теперь, в каталоге resource/views/layouts создаём файл шаблона адиин панели и назовём, например, admin_layout.blade.php
php расширение файла php, blade это для шаблонизатора laravel, который носит имя blade.
И из index.html из распакованного архива  adminLTE копируем содержимое в admin_layout.blade.php

 <p style="text-indent:30px">В каталоге public/views  создаём папку admin и туда копируем готовые стили и скрипты, которые находятся, как вы догадались, в каталогах dist и plugin. Как догадались? Да очень просто. В index.html - >head указан путь в теге <link href="dist/... " >. Нам здесь нужен только bootstrap и dist =...
 <p style="text-indent:30px">Остальные скрипты и стили можно вообще не подключать пока. Для  подключения изменим адрес, но не просто укажем путь, добавив admin, чтобы мы потом не имели проблем с относительными путями. Ведь стили и скрипты, и шаблоны в разных каталогах.
Изменим  href = plugins/... href = admin/plugins, src ="{{asset('admin/dist/...')}} " и plugins, и dist, и в head styles, и в scripts.
Так вот, этот вот asset будет генерировать абсолютный URL адрес.  С помощью функции asset всегда создается адрес, который связан с приложением. И все. Вам не надо париться с URL адресами и не будет проблем со стилями и скриптами. 
//=========================
  <p style="text-indent:50px">Теперь, создадим шаблон показа или отображения, вьюшку для админки:
  <p style="text-indent:50px">Создаём файл admin.blade.php и в нем прописываем
<code>
 @extend('layouts.admin_layout').
</code>
  <p style="text-indent:50px">Теперь создадим  route в routes/web.app
<code>
Route::get('/admin',function(){return view('admin') });
</code>
  <p style="text-indent:50px">И теперь, в адресной строке браузера вводим 
<code>
http://localhost:8001/admin
</code>
  <p style="text-indent:50px">Админка должна открыться в красивом виде. Если вид некрасивый, проверять  линки.
Редактируем шаблон admin_layout. Оставим только меню sidebar, head, footer. Остальное все удаляем.

  <p style="text-indent:50px">На место удалённого пишем
<code>
  @yield('content')
</code>
  <p style="text-indent:50px">На это  место шаблонизатор подставит содержимое секции content.
А секция  content находится в файле, в котором мы подключали наш шаблон админки, т.е., в admin_layout.blade.php
И теперь наш файл выглядит так:
<code>
<br>
@extends('layouts.admin_layout')
<br>
@section('content')
<br>
<p> Temp Content
<br>
@endsection
</code>
 <p style="text-indent:30px">Все это была так, развлекуха для знакомства с шаблонизатором BLADE и основами роутинга в Laravel. 

    <p style="text-indent:30px">Поиграли, хватит. Из web.app удаляем, созданный route, потому что это наша админка и доступ к ней только админам))),т.е., юзерам, имеющим права на доступ к админке. В нашем случае, как вы помните это второй юзер с role_id = 2.
  <p style="text-indent:50px">	Пришло время познакомимся с контроллерами.
   <p style="text-indent:30px"> В Laravel вся работа идет через контроллеры.
    В данном случае, мы хотим открыть нашу админку, введя в браузере URL адрес http://VladimirBoiko/admin_panel - если сайт уже на хостинге 
	Или http://localhost:8001/VladimirBoiko/admin_panel - если сайт еще на локальном диске.

    <p style="text-indent:30px">Создадим контроллер, введем в терминале: 
<code>
    php artisan make:controller admin/HomeController
</code>
   <p style="text-indent:30px"> Эта команда создаст контроллер и папку admin в каталоге Controllers, если ее нет.
    <p style="text-indent:30px">Контроллеры это не что иное, а классы. А у классов имеются методы или функции. Можно зайти на сайт laravel  и посмотреть как выполняется маршрутизация. А можно понять и запомнить, что контроллер это класс, и класс сам по себе просто описание  будущих объектов. Но класс имеет методы. Вот к методам класса мы и обращаемся при выполнении запроса, например, HomeController.index или в web.app 
<code>
Route::get('/home', [App\Http\Controllers\HomeController::class, 'index']);
</code>
 По ссылке home мы вызываем метод Index в  HomeController . Пример окончен.
    <p style="text-indent:30px">Переходим в app/Http/Controllers/admin/ и создадим метод Index в файле HomeController.php 

<p><code>
    public function index(){
    return view('admin.index');
    }
	</code>
<p style="text-indent:30px">Это значит, что при обращении к контроллеру, контроллер нам вернет страницу index.blade.php, которая находится в каталоге admin.
<p style="text-indent:30px">Тут следует отметить, что ваш проект будет иметь несколько таблиц, а контроллер создается для каждой таблицы, с которой вы хотите работать, то в каталоге admin или front условно, надо создавать каталог, например, admin/articles/index_article.blade.php. Т.е., страницы для articles хранятся в каталоге articles. Страницы для, например, themes или categories хранятся в каталоге admin/themes/index_themes.blade.php.Таже история и фронтом, например, front/articles/index_artilce.blade.php. Иначе путаница гарантирована.  Тогда URL адрес будет таким в контроллере:
<code>
return view('admin.article.index_articles');
</code>   
  <p style="text-indent:30px"> Файл index_article.blade.php разместим в каталоге resource/views/admin/articles/
 В route пишем следующую конструкцию:
<p><code>
Route::middleware(['role:admin'])->prefix('admin_panel')->group( function () {
Route::get('/', [App\Http\Controllers\Admin\HomeController::class, 'index']);
});
</code>
Что мы сделали? Мы наш запрос отдали посреднику middleware, который фильтрует запросы. Если пользователь авторизован, то его запрос будет обработан и направлен к админ панели. Если нет, откроется страница ответа, что пользователь не авторизован или не имеет прав доступа.
  <p style="text-indent:50px">Мы пока просто все делаем. 
А вообще, посредники мы можем создавать сами. С помощью всемогущего  artisan 
<code>
php artisan make:middleware OurToken
</code>
Эта команда создаст класс посредника в каталоге:
<p>
app/Http/Middleware
<p>
Здесь доступ к маршруту только в том случае, если значение входящего   token соответствует указанному. В противном случае мы перенаправим пользователя по маршруту home:
<p><code>
public function handle($request, Closure $next) { 
<br>
if ($request->input('token') !== 'mytoken')
 <br>
 { 
 <br>
	return redirect('home');	
	<br>
 } 
 <br>
 return $next($request); 
 <br>
}
</code>
  <p style="text-indent:50px">Здесь $next($request) замыкание.
  <p style="text-indent:50px">Но мы не создавали посредника, а зарегистрировали его раньше в app/Http/Kernel.php
  <p style="text-indent:50px">
Проверяем, введя в адресной строке браузера
<code>
Http://licalhost:8001/admin_panel
</code>  
<p style="text-indent:50px">И проверяем работу с авторизованным и с неавторизованным пользователями.

  <p style="text-indent:50px">У нас есть авторизация и теперь нам надо создавать контент. У нас также есть база данных. Что такое наш контент? Наш контент есть текстовые и графические данные, а попросту, статьи. Также нам нужны темы статей.
Ещё нужны авторы. Всю эту информацию мы будем хранить в таблицах. Так давайте создадим таблицы.
<code>
php artisan make:migration create_articles_table
</code>
<p style="text-indent:30px">Что мы сделали? 
Мы создали прототип таблицы. Находятся таблицы в каталоге database\migrations.
Открываем и редактируем.
Тоже самое с таблицами autors, themes, authors. Мы создали таблицы, но в базе данных их нет. Мы можем их редактировать.
Появятся таблицы в нашей базе только после того, как мы применим миграцию:
 <code>
php artisan migration
</code>
и теперь таблицы в базе данных.
  <p style="text-indent:50px">Чтобы пользоваться таблицами, мы создадим модели к контроллерам, а если контроллеров нет, то и контроллеры создадим:
<code>
php artisan make:model Article
</code>
или
<code>
php artisan make:controller ArticleController --resource или с моделями
</code>
или
<code>
php artisan make:controller ArticleController --model=Article --resource --requests
</code>
А это ресурсный контроллер. В таком контроллере уже имеются методы index, create, edit, show, destroy.
Нам осталось только заполнить эти методы.
  <p style="text-indent:50px">Немножко добавим. Никто не запрещает нам создать контроллер просто создав файл OurController в каталоге http/controllers и создав методы.
  <p style="text-indent:50px">Продолжим работу с таблицами.
Выглядит это так.
  <p style="text-indent:50px">Например, таблица articles, контроллер ArticleController, модель Article. Задача - вывести все статьи из таблицы. В контроллере в методе index пишем:
<code>
$articles = Article::orderBy('id', 'desc') - >get() ;
</code>
  <p style="text-indent:50px">В данном случае это почти то же самое, что и выполнить sql запрос $articles = Select * from table articles. И далее, мы переменную, а это массив, передаём вьюшке index_articles.blade.php.
А можно уйти от Laravel и сделать запрос к любой таблице с помощью sql, например,
<code>$ article = DB::select('select * from articles where id = :id', ['id' => 1]);
return views('index_articles', ['articles' =>$articles]) ;
</code>
Но в этом случае нужно добавить класс DB
<code>
use Illuminate\Support\Facades\DB;
</code>
  <p style="text-indent:50px">В созданной нами вьюшке, мы принимаем переменную и работаем с ней. Если вы работали или изучали php, то вы знаете, что все переменные находятся в $_server. Мы можем получить их так:
<code>
$var=$_post[`index'] или  $_get[], или $_server[].
</code>
В laravel мы просто работаем с переменной:
<code>
@foreach($articles as $article)
@article['id'] //это если массив
@article->id// если обьект

@endforeach
</code>
Что за объект? Почему массив?
Здесь ответ
  <p style="text-indent:50px">Продолжим.
  <p style="text-indent:50px">Данные в view index_article будет выводить в таблицу.
Таблица создаётся html тэгами <table>
Строки <tr>.
Столбцы <td>.
Стили задаются  style, можно и нужно использовать  bootstrap.
Но! У нас есть админ панель adminlte, где в каталоге Example, есть таблицы. И мы с копируем оттуда подходящую для нас таблицу. В принципе, нам нужны только заголовок и стили, плюс одна строка, которую мы будем выводить данные.
Это выглядит вот так:
<p><code>
@extends('layouts.admin_layout')
@section('content')
<table>
@foreach($articles as $article)
  <tr>
<td>$article['id']</td>
</tr>
<tr>
<td>$article['title']</td>
</tr>
<tr>
<td>$article['text']</td>
</tr>
</table>
@ebdforeach
</table>
@endsection

</code>
И теперь осталось только изменить меню.
<p style = "text-indent:50px">Найдём в шаблоне admin_layout.blade.php sidebar. Это боковое меню. Отредактируем его.

  <p style="text-indent:50px">Вместо Dashboard v1 пишем "Все статьи"
link для всей статьи меняем на <link href="{{route('articles.index')}}" rel="stylesheet"> 	
<p style = "text-indent:50px">Готово. Все статьи выведены. Но нам надо  их создавать, редактировать, показывать, удалять в конце концов.

<p style = "text-indent:50px">Если вы копировали из нашего примера, то видите кнопки edit, show, delete. Нам остается только добавить пункт "Создать статью" и запрограммировать работу. 
В меню вместо Dashboard v2 пишем Создать статью. Адресация <href="{{route('articles.create')}}">
В данном случае мы переходим по ссылке articles и передаем параметр create, т.е., обращаемся к методу create класса ArticleController.
В контроллере в методе create мы пишем:
<code>        
return view('admin.articles.create');
		</code>
		В каталоге admin/articles создаем шаблон create_article.blade.php
		Туда копируем все из index.blade.php. И content удаляем. Вместо него вставляем форму с Inputs для id, title, authors и textarea для текста статьи.
		Чтобы много не писать, приведу форму:
	<code>
 <form action="{{route('article.store')}}" method="POST">
			 </code>
			
В контроллере меняем метод store:
<p><code>
   public function store(Request $request){
   $new_article = new article();
		$new_article->title=$request->title;
		$new_article->text=$request->text;
		$new_article->save();
		return redirect()->back()->withSuccess('article was success addition');
	}
	</code>
  <p style="text-indent:50px">	Здесь важно, чтобы name совпали с name полей таблицы, а то всякое, знаете ли бывает.)) Кхм, не, у меня ничего такого не было.  
	
  <p style="text-indent:50px">	Все. Открывает, создаем, сохраняем.
	
  <p style="text-indent:50px">	Все точно также и с edit, delete,show. Только маршруты другие, да добавляется конкретный id.
	 <p>В edit_article.blade.php
	<p><code>
 <p>	div class="card card-primary"
              <p> div class="card-header"
                <p> h3 class="card-title"Edit article: {{$article['title']}} /h3
              <p> /div
             <p>  !-- /.card-header --
              !-- form start --

              <p> form action="{{route('articles.update',$article['id'])}}" method="POST"
			 <p>  @csrf
			 // @method('PUT')//
                 <p>div class="card-body"
                  <p>div class="form-group"
                     <p>input type="text" class="form-control" name="title" value="{{$article['title']}}"
                   <p>/div
                   <p>div class="form-group"
                     <p>label for="exampleInputPassword1"article description/label
                     <p>input type="text" class="form-control" name = "text value="{{$article['text']}}"
                   <p>/div
                <p> /div
              <p>   !-- /.card-body --
              /form
			  
            /div
	</code>
	  <p> p style="text-indent:50px"как видим route 
<code>
 <p>	action="{{route('articles.update',$article['id'])}}"
</code>	
В edit мы вызываем вьюшку
<code>
return view('admin.articles.edit_article');
</code>
	
	Метод update
	<p><code>
	public function update(Request $request, article $article)
    {
        $article-title = $request-title;
        $article-text = $request-text;
		$article-save();
		return redirect()-back()-withSuccess('article was success updating');
    }
</code>
	Delete 
	<p><code>
           <p>             form action="{{route('articles.destroy',$article['id'])}}" method="post" style="display:inline-block"
	 <p>					  @csrf
		 <p>				 @method('DELETE')//
                        
				</code>
	<p> Здесь объяснять особенно нечего.
	 <p>В контроллере пишем в методе destroy:
	 <p><code>
	 $article - delete();
	 return redirect()-back()-withSuccess('article was success deleting');			  
	</code>
	<p>	Осталось реализовать метод show():
		
<p><code>
<p>	public function show(Category $category)
	{
			$category = category::find($category['id']);
			return view('category.show')-with('category', $category);
	}
</code>
 <p>Здесь вообще все понятно. 
		
	  <p  style="text-indent:50px">Вот таким образом я и создавал данный сайт. Проект на github.com/vladboiko
	<p>Многие моменты я  здесь я показал в упрощенной форме. Для понимания.  Главное, направление!
	<p><a href = "haking">Часть следующая, заключительная, тестирование на безопасность.</a>
			
==================================== Эпилог ==================================================		
		<p style="text-indent:50px">Вместо эпилога. Вот создавал я сайты на голом PHP и было много путаницы. Использовал фреймворк, но путаница осталась. А почему? А потому что делалось все без проектирования и без всякого плана! А нет проектирования, нет успеха!   К сожалению, статья написана наспех. Хотел прилизать ее, но потом передумал - пусть будет, как напоминание о том, что быстро не значит хорошо. 
		<p style="text-indent:50px">Поэтому, следующий проект делаем не спеша и вдумчиво и начинаем с проектирования, как настоящий инженер!<p> <a href="design">Здесь принципы проектирования приложений  и пример.</a>
		<p style="text-indent:50px">Первый проект завершен!
			
		
